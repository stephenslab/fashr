% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_fash.R
\name{simulate_IWP}
\alias{simulate_IWP}
\title{Simulate functions from an integrated Wiener process prior}
\usage{
simulate_IWP(
  n_samps = 1,
  n_basis = 20,
  psd = 1,
  sd_poly = 0.1,
  p = 1,
  pred_step = 1,
  x_range = NULL,
  x_new = NULL
)
}
\arguments{
\item{n_samps}{Integer; number of function samples to draw.}

\item{n_basis}{Integer; number of spline basis functions (i.e., number of
knots). Must be at least 3.}

\item{psd}{Numeric; target predictive standard deviation (PSD) for the IWP
component, on the scale implied by \code{pred_step}.}

\item{sd_poly}{Numeric; standard deviation for the global polynomial
coefficients.}

\item{p}{Integer; order of the integrated Wiener process / local polynomial.}

\item{pred_step}{Numeric; prediction step size used in the PSD scaling
formula.}

\item{x_range}{Numeric vector of length 2 giving the range of the input
domain \code{[x_min, x_max]}. If \code{NULL}, defaults to \code{c(0, 10)}.
Used to construct the knot locations.}

\item{x_new}{Optional numeric vector giving the evaluation points at which
the sampled functions should be returned. If \code{NULL}, 100 equally
spaced points over \code{x_range} are used.}
}
\value{
A list with elements:
\describe{
  \item{samples}{A numeric matrix of dimension
    \code{length(x_new) × n_samps} containing the simulated function values.
    Each column corresponds to one function sample, and each row corresponds
    to an evaluation point in \code{x_new}.}
  \item{x_new}{The numeric vector of evaluation points at which the
    functions are simulated.}
}
}
\description{
This internal helper simulates sample paths from an integrated Wiener process
(IWP)–type prior using a spline basis plus a low-order global polynomial
trend. The spline coefficients are drawn from a multivariate normal
distribution with a precision matrix constructed from the knot locations,
scaled to achieve a target predictive standard deviation (PSD). The global
polynomial coefficients are drawn independently from a normal prior.
}
\details{
The function constructs a spline basis over \code{x_range} using
\code{n_basis} knots, and a global polynomial design of order \code{p} over
\code{x_new}. Spline coefficients are sampled from a multivariate normal
distribution with precision matrix
\deqn{Q = \frac{1}{\sigma^2} Q_{\text{IWP}}(knots),}
where \code{Q_IWP} is computed by \code{compute_weights_precision_helper()}
and \code{sigma} is chosen so that the resulting process has predictive
standard deviation approximately equal to \code{psd} at step size
\code{pred_step}. The global polynomial coefficients are sampled
independently from \eqn{N(0, \text{sd\_poly}^2)}.
}
\examples{
\dontrun{
  sim <- simulate_IWP(n_samps = 5, n_basis = 20, psd = 1, p = 2)
  # Each column is a sample
  matplot(sim$x_new, sim$samples, type = "l", lty = 1,
          xlab = "x", ylab = "Sampled function")
}

}
\keyword{internal}
